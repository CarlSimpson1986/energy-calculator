<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Your Bespoke Calorie Targets</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    :root {
      --bg: #0b0b0b;
      --panel: #141414;
      --gold: #d4af37;
      --text: #eaeaea;
      --muted: #9a9a9a;
      --border: rgba(212,175,55,.2);
    }

    * {
      box-sizing: border-box;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    }

    body {
      margin: 0;
      min-height: 100vh;
      background: radial-gradient(circle at top, #1a1a1a, var(--bg));
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 24px;
      color: var(--text);
    }

    .card {
      width: 100%;
      max-width: 820px;
      background: linear-gradient(180deg, #161616, #0e0e0e);
      border-radius: 20px;
      padding: 40px;
      box-shadow: 0 30px 80px rgba(0,0,0,.6);
    }

    h1 {
      margin-top: 0;
      text-align: center;
      color: var(--gold);
      font-size: 2.2rem;
    }

    .sub {
      text-align: center;
      color: var(--muted);
      max-width: 620px;
      margin: 12px auto 36px;
      line-height: 1.6;
    }

    .results-box {
      background: var(--panel);
      border-radius: 16px;
      padding: 28px;
      margin-bottom: 40px;
      border: 1px solid var(--border);
    }

    .row {
      display: flex;
      justify-content: space-between;
      padding: 14px 0;
      border-bottom: 1px solid rgba(255,255,255,.06);
    }

    .row:last-child {
      border-bottom: none;
    }

    .row span {
      color: var(--muted);
    }

    .row strong {
      color: var(--gold);
      font-size: 1.1rem;
    }

    .explain {
      text-align: center;
      border-top: 1px solid rgba(255,255,255,.08);
      padding-top: 36px;
    }

    .explain h2 {
      color: var(--gold);
      margin-bottom: 10px;
    }

    .explain p {
      color: var(--muted);
      max-width: 540px;
      margin: 0 auto 24px;
      line-height: 1.6;
    }

    /* Kartra form should NOT be wrapped tightly */
    .kartra-container {
      max-width: 420px;
      margin: 0 auto;
    }
  </style>
</head>

<body>

<div class="card">

  <h1>Your Bespoke Calorie Targets</h1>
  <p class="sub">
    Based on your inputs, here’s the calorie and macro structure that will drive
    results without wrecking energy, performance, or sanity.
  </p>

  <div class="results-box">
    <div class="row">
      <span>Daily Calories</span>
      <strong id="calories">—</strong>
    </div>
    <div class="row">
      <span>Protein</span>
      <strong id="protein">—</strong>
    </div>
    <div class="row">
      <span>Carbohydrates</span>
      <strong id="carbs">—</strong>
    </div>
    <div class="row">
      <span>Fats</span>
      <strong id="fats">—</strong>
    </div>
  </div>

  <div class="explain">
    <h2>Want the full explanation?</h2>
    <p>
      These numbers may differ from what you’ve seen in MyFitnessPal or other calculators.
      That’s deliberate. If you want, I’ll explain exactly why — and how to adjust this
      without undoing progress.
    </p>

    <!-- KARTRA FORM (INLINE FORM ONLY) -->
    <div class="kartra-container">
      <script src="https://app.kartra.com/resources/js/kartra-embed.js"></script>
      <div
        class="kartra_embed"
        data-kt-type="optin"
        data-kt-id="YOUR_FORM_ID">
      </div>
    </div>
  </div>

</div>

<script>
  // Redirect if page is loaded without data
  const raw = localStorage.getItem("calorieCalculatorData");
  if (!raw) {
    window.location.href = "calculator.html";
  }

  const data = JSON.parse(raw);

  const age = +data.age;
  const height = +data.height;
  const weight = +data.weight;
  const sex = data.sex;
  const activity = data.activity;
  const goal = data.goal;

  // BMR (Mifflin-St Jeor)
  const bmr = sex === "male"
    ? (10 * weight + 6.25 * height - 5 * age + 5)
    : (10 * weight + 6.25 * height - 5 * age - 161);

  const activityMap = {
    sedentary: 1.2,
    light: 1.375,
    moderate: 1.55,
    very_active: 1.725
  };

  const goalMap = {
    fat_loss: 0.8,
    maintain: 1.0,
    muscle_gain: 1.1
  };

  const calories = Math.round(bmr * activityMap[activity] * goalMap[goal]);

  // Macros (simple, adjustable later)
  const protein = Math.round(weight * 1.8);
  const fats = Math.round((calories * 0.25) / 9);
  const carbs = Math.round((calories - (protein * 4) - (fats * 9)) / 4);

  document.getElementById("calories").innerText = calories + " kcal";
  document.getElementById("protein").innerText = protein + " g";
  document.getElementById("carbs").innerText = carbs + " g";
  document.getElementById("fats").innerText = fats + " g";
</script>

</body>
</html>

